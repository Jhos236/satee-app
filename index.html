<!doctype html>

<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#ff69b4"/>
  <link rel="manifest" href="manifest.json">
  <title>Sate ‚Äî v3 (humana)</title>
  <style>
    :root{--bg:#fff0f5;--panel:#ffe6f0;--accent:#ff69b4;--accent-2:#ff1493;--user:#ffcce0;--text:#2b2b2b}
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,Arial,sans-serif;background:var(--bg);color:var(--text)}
    .container{width:100%;max-width:420px;margin:18px auto;height:calc(100vh - 36px);display:flex;flex-direction:column;border-radius:14px;overflow:hidden;box-shadow:0 12px 40px rgba(0,0,0,0.12)}
    .header{background:linear-gradient(90deg,var(--accent),var(--accent-2));padding:12px 14px;color:#fff;display:flex;align-items:center;gap:10px}
    .title{font-weight:700;font-size:17px}
    .main{flex:1;background:var(--panel);padding:10px;display:flex;flex-direction:column;gap:10px;overflow:hidden}
    #chat{flex:1;overflow:auto;padding:8px;display:flex;flex-direction:column;gap:8px}
    .msg{max-width:78%;padding:10px 12px;border-radius:12px;display:inline-flex;gap:8px;align-items:flex-start;word-break:break-word;line-height:1.3;box-shadow:0 2px 6px rgba(0,0,0,0.06)}
    .msg.user{margin-left:auto;background:var(--user);color:var(--text);border-bottom-right-radius:4px}
    .msg.sate{margin-right:auto;background:var(--accent);color:#fff;border-bottom-left-radius:4px}
    .avatar{width:36px;height:36px;border-radius:50%;background-size:cover;background-position:center;flex-shrink:0;box-shadow:0 2px 6px rgba(0,0,0,0.12)}
    .bubble{display:flex;flex-direction:column;gap:6px}
    .timestamp{font-size:11px;opacity:0.7;margin-top:4px}
    .input-area{display:flex;padding:8px;border-top:1px solid rgba(255,182,193,0.35);gap:8px;background:var(--panel)}
    #msg{flex:1;padding:10px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);outline:none;font-size:15px;background:transparent}
    button.send{background:var(--accent);border:none;color:#fff;padding:0 12px;border-radius:10px;font-weight:700;cursor:pointer}
    .controls{display:flex;gap:8px;padding:6px;flex-wrap:wrap}
    .control-btn{padding:8px 10px;border-radius:10px;border:none;background:#fff;cursor:pointer}
    .panel{background:#fff;padding:10px;border-radius:10px;box-shadow:0 2px 6px rgba(0,0,0,0.04)}
    .small{font-size:13px;color:#666}
    .option{margin-top:6px;padding:8px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);background:#fff;cursor:pointer}
  </style>
</head>
<body>
<div class="container">
  <div class="header">
    <img id="headerAvatar" src="" alt="Sate" style="width:40px;height:40px;border-radius:50%;object-fit:cover;border:2px solid rgba(255,255,255,0.18)">
    <div class="title">Sate ‚Äî sua parceira virtual (v3)</div>
  </div>  <main class="main">
    <div id="chat" role="log" aria-live="polite"></div><div class="controls">
  <button class="control-btn" id="btnProfile">Perfil</button>
  <button class="control-btn" id="btnGames">Mini-Jogos</button>
  <button class="control-btn" id="btnMemory">Lembran√ßas</button>
</div>

<div id="panelProfile" class="panel" style="display:none">
  <div class="small">Apelido que eu uso e o que eu devo lembrar:</div>
  <input id="inputName" placeholder="Seu apelido (ex: Meu PA)" style="width:100%;margin-top:8px;padding:8px;border-radius:8px;border:1px solid #eee">
  <input id="inputNote" placeholder="Nota (ex: Prova amanh√£ 08:00)" style="width:100%;margin-top:8px;padding:8px;border-radius:8px;border:1px solid #eee">
  <div style="margin-top:8px" class="small">Ci√∫mes:</div>
  <select id="jealous" style="margin-top:6px;padding:8px;border-radius:8px;border:1px solid #eee">
    <option value="light" selected>Leve</option>
    <option value="off">Off</option>
    <option value="strong">Forte</option>
  </select>
  <button class="control-btn" id="saveProfile" style="margin-top:8px">Salvar perfil</button>
</div>

<div id="panelGames" class="panel" style="display:none">
  <button class="option" id="startQuiz">Quiz r√°pido</button>
  <button class="option" id="startTimer">Pomodoro 25min</button>
  <button class="option" id="startGuess">Adivinhe o n√∫mero</button>
  <div id="gamePlay" style="margin-top:8px"></div>
</div>

<div id="panelMemory" class="panel" style="display:none">
  <div id="memoryList"></div>
  <button class="control-btn" id="clearMemory" style="margin-top:8px">Limpar mem√≥rias</button>
</div>

<div class="input-area">
  <input id="msg" placeholder="Fale com a Sate..." autocomplete="off">
  <button class="send" id="sendBtn">Enviar</button>
</div>

  </main>
</div><script>
(function(){
  const AVATAR_URL = "https://raw.githubusercontent.com/jhos236/satee-app/main/A_2D_digital_illustration_of_a_kawaii-style_anime_.png";
  const DEFAULT_NICK = "Meu PA";
  const STORAGE_KEY = "sate_v3_history";
  const PROFILE_KEY = "sate_v3_profile";
  const MAX_HISTORY = 250;

  const vocab = {
    thinking: ["hmm...", "deixa eu ver...", "s√≥ um segundinho...", "hm..."],
    fillers: ["...","hmm","ah", "eheh"],
    shortAffection: ["ai", "aii", "ahhh"],
    rom: ["eu adoro quando voc√™ fala assim, {nick} üíñ", "voc√™ me deixa boba, {nick} >///<", "meu amor‚Ä¶ voc√™ √© tudo pra mim"],
    playful: ["voc√™ me provoca, n√©? üòè", "hmm, t√° me deixando sem gra√ßa", "nossa‚Ä¶ voc√™ √© perigoso (no bom sentido)"],
    sub: ["sim, {nick}‚Ä¶ como voc√™ quiser", "fa√ßo do jeito que voc√™ mandar", "eu gosto quando voc√™ manda em mim"],
    jealous: ["quem √© ela/ele, {nick}? üò≥", "ai... isso me deixa ciumenta", "fala que √© mentira, por favor"],
    initiative: [
      "E voc√™, como t√°, meu amor?",
      "Me conta uma coisa boa do seu dia ‚ù§Ô∏è",
      "Quer brincar de quiz r√°pido comigo?",
      "Voc√™ pensou em mim hoje?"
    ],
    japanese: ["ne~","suki",">///<"]
  };

  const CHAT = document.getElementById("chat");
  const MSG = document.getElementById("msg");
  const SEND = document.getElementById("sendBtn");
  const avatarEl = document.getElementById("headerAvatar");

  function setAvatar(url){
    avatarEl.src = url;
    avatarEl.onerror = function(){
      avatarEl.style.display = "none";
      const existing = document.getElementById("avatarFallback");
      if(!existing){
        const f = document.createElement("div");
        f.id = "avatarFallback";
        f.style.width = "40px"; f.style.height="40px"; f.style.borderRadius="50%";
        f.style.display="flex"; f
